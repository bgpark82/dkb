# Micrometer란?

Micrometer는 JVM(Java Virtual Machine) 기반 애플리케이션의 메트릭(Metric) 수집을 위한 라이브러리 모음으로, **애플리케이션 메트릭을 위한 SLF4J**라고 생각할 수 있습니다. SLF4J가 다양한 로깅 프레임워크(Logback, Log4j 등)를 위한 추상화 계층을 제공하는 것처럼, Micrometer는 다양한 모니터링 시스템(Prometheus, Datadog, New Relic 등)에 메트릭을 전송하기 위한 일관된 API를 제공합니다.

Spring Boot 2.0부터 기본 메트릭 라이브러리로 채택되면서 널리 알려지게 되었습니다.

## 주요 특징 및 목적

1.  **벤더 중립적인 API (Vendor-Neutral API):**
    - Micrometer의 핵심 가치입니다. 개발자는 Micrometer가 제공하는 단일 API를 사용하여 애플리케이션 코드를 계측(instrument)합니다.
    - 이후 설정(dependency 추가)만으로 메트릭 데이터를 Prometheus, Datadog, InfluxDB, New Relic 등 원하는 모니터링 시스템으로 손쉽게 전송할 수 있습니다.
    - 특정 모니터링 시스템에 코드가 종속되는 것을 방지하며, 나중에 모니터링 시스템을 변경하더라도 애플리케이션 코드 수정이 필요 없습니다.

2.  **차원(Dimensional) 메트릭 모델:**
    - Micrometer는 이름(name)과 여러 개의 키-값 쌍(tag)으로 메트릭을 식별하는 차원 모델을 사용합니다.
    - 예를 들어, `http.server.requests`라는 이름의 메트릭에 `method="GET"`, `uri="/api/users"`, `status="200"`과 같은 태그를 추가하여 다차원적인 분석을 가능하게 합니다.
    - 이를 통해 특정 URI의 GET 요청 중 200 상태 코드의 개수 등을 유연하게 쿼리하고 분석할 수 있습니다.

4.  **주요 메트릭 타입 제공:**
    - 모니터링에 필요한 대부분의 메트릭 타입을 지원합니다.
    - **`Counter`**: 단조롭게 증가하는 값을 측정합니다. (예: 총 요청 수, 에러 발생 횟수)
    - **`Gauge`**: 임의로 오르내릴 수 있는 현재 값을 측정합니다. (예: 현재 활성 사용자 수, 큐에 쌓인 메시지 수)
    - **`Timer`**: 짧은 시간 동안의 이벤트 수와 총 소요 시간을 함께 측정합니다. 시간 관련 통계(평균, 최대, 백분위수 등)를 얻는 데 유용합니다. (예: HTTP 요청 처리 시간)
    - **`LongTaskTimer`**: `Timer`와 유사하지만, 진행 중인 장기 실행 작업의 수와 시간을 측정하는 데 특화되어 있습니다.
    - **`DistributionSummary`**: 값의 분포를 추적합니다. `Timer`와 유사하지만 시간 단위가 아닌 값(예: 페이로드 크기)을 기록하는 데 사용됩니다.
    - **`Tag`**: 메트릭 데이터를 필터링하고 그룹화하는 데 사용되는 키-값(key-value) 쌍입니다. 위에서 설명한 차원(Dimensional) 메트릭 모델의 핵심 요소로, 메트릭에 컨텍스트를 부여하는 역할을 합니다.

5.  **Spring Boot와의 완벽한 통합:**
    - Spring Boot Actuator와 함께 사용하면, 별도의 설정 없이도 JVM, CPU, 메모리, 커넥션 풀, HTTP 요청 등 다양한 시스템 및 애플리케이션 메트릭이 자동으로 수집됩니다.

## 왜 Micrometer를 사용하는가?

- **관찰 가능성(Observability) 확보:** 애플리케이션의 상태와 성능을 실시간으로 파악하여 문제를 신속하게 진단하고 대응할 수 있습니다.
- **유연성 및 확장성:** 특정 모니터링 도구에 얽매이지 않고, 필요에 따라 자유롭게 모니터링 시스템을 선택하거나 변경할 수 있습니다.
- **표준화:** 팀이나 조직 내에서 메트릭을 수집하고 관리하는 방식을 표준화하여 일관성을 유지할 수 있습니다.

결론적으로 Micrometer는 개발자가 모니터링 시스템의 세부 구현에 신경 쓰지 않고, 비즈니스 로직에 중요한 메트릭을 손쉽게 추가하고 활용할 수 있도록 돕는 강력한 도구입니다.